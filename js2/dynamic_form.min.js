var re_to_ec={rE:"",rE_doc_type:"",rE_tit_ov:"",init:function(){this.rE=new Rule_Engine,this.rE_doc_type=new Rule_Engine,this.rE_tit_ov=new Rule_Engine,this.rE.set_ajPath("ajCalls/ruleCalls.php").set_tool("DisclosureTool").set_exactMatch(!0).set_procType(1),this.rE_doc_type.set_ajPath("ajCalls/ruleCalls.php").set_tool("DisclosureTool_DocType").set_exactMatch(!0).set_procType(1),this.rE_tit_ov.set_ajPath("ajCalls/ruleCalls.php").set_tool("DemoOrderTitle").set_exactMatch(!0).set_procType(1)},update:function(t){var e=this.rE.compute_rules(t.id),a=this.rE_doc_type.compute_rules(t.id);if(this.rE.enabledResults&&this.rE.enabledResults[t.id]){var s=this.rE.enabledResults[t.id];$.each(s,function(t,e){var a=JSON.parse(e.result_options);$("#formContainer").dynamicform("Undo"+e.result_method,a)})}if(this.rE_doc_type.enabledResults&&this.rE_doc_type.enabledResults[t.id]){var i=this.rE_doc_type.enabledResults[t.id];$.each(i,function(t,e){var a=JSON.parse(e.result_options),s=void 0===typeof a.div_id?"doc_type_container_std":a.div_id;"CreateForm"!==e.result_method?$("#"+s).dynamicform("Undo"+e.result_method,a):$("#"+s).dynamicform("Destroy")})}$.each(e,function(t,e){var a=JSON.parse(e.result_options);$("#formContainer").dynamicform(e.result_method,a)}),this.rE.set_enabledResults(e,t.id),$.each(a,function(t,e){var a=JSON.parse(e.result_options),s="undefined"==typeof a.div_id?"doc_type_container_std":a.div_id;"undefined"!=typeof a.div_id&&0===$("#"+s).length?($("#doc_type_container_var").append('<div id="'+s+'" class="doc_type row formContainer top-inputs"></div>'),$("#"+s).dynamicform(a),$(".doc_type_switch").bootstrapSwitch(),ls_helper.switchFunction()):($("#"+s).dynamicform(e.result_method,a),"block"===$("#"+s+" .row:nth-child(2)").css("display")&&$("#"+s).find(".row").show())}),this.rE_doc_type.set_enabledResults(a,t.id)}},ls_helper={switchFunction:function(){$(".doc_type_switch").off("switchChange.bootstrapSwitch"),$(".doc_type_switch").on("switchChange.bootstrapSwitch",function(){$(this).prop("checked")?($(this).parents(".doc_type_row").siblings("div").slideDown("slow"),$(this).parents(".doc_type").addClass("doc_type_pr")):($(this).parents(".doc_type_row").siblings("div").slideUp("slow"),$(this).parents(".doc_type").removeClass("doc_type_pr"))})}},ajCalls={ajPath:"",client_id:1,agent_id:1,county:"",trans:[],loadStates:function(){var t={};return $.ajax({url:this.ajPath,type:"post",async:!1,data:{method:"getSupportedStates",options:{client_id:this.client_id,agent_id:this.agent_id}},dataType:"json",success:function(e){$.each(e,function(e,a){t[a]=a})}}),t},getCounties:function(t){var e=this;$.ajax({url:this.ajPath,type:"post",async:!0,data:{method:"getCounties",options:{state:t,client_id:e.client_id,agent_id:e.agent_id}},success:function(a){$("#county").html(a),e.county=$("#county").val(),e.getTownships(t,e.county,e.client_id,e.agent_id),$(".visuallyhidden").removeClass("visuallyhidden")}})},getTownships:function(t,e){$.ajax({url:this.ajPath,type:"post",async:!0,data:{method:"getTownships",options:{state:t,county:e,client_id:self.client_id,agent_id:self.agent_id}},success:function(t){$("#township").html(t)}})},getTransactions:function(){var t=this;$.ajax({url:this.ajPath,type:"post",dataType:"json",async:!0,data:{method:"getTransactions",options:{}},success:function(e){t.trans=e}})},postForm:function(t){$.ajax({url:this.ajPath,type:"post",async:!1,dataType:"json",data:{method:"genDynamicJSON",options:t},success:function(t){$("#mask, #ov_card").show(),$.each(t,function(t,e){var a=e.attribute.div_id;delete e.attribute.div_id,null===e.title&&delete e.title,"undefined"!=typeof $("#"+a).data(".jquery.dynamicform")&&($("#"+a).dynamicform("Empty",!0),$("#"+a).dynamicform("AddFormElements",e)),$("#"+a).dynamicform(e)})},error:function(t,e,a){console.log("ajax answer post returned error "+t+" "+e+" "+a)}})},email:function(t,e,a,s){$.ajax({url:this.ajPath,type:"post",async:!0,data:{method:"emailLoanEstimate",options:{to_name:t,subject:e,email_body:a,attachment:s}},success:function(t){alert(t)}})}},titCalls={ajPath:"int/int_handler.php",postTitle:function(t,e,a){$.ajax({url:this.ajPath,type:"post",async:!0,data:{method:a,options:{message:{body:t},login:{},meta_data:e}},success:function(t){alert("Your order has been sent! You should be receiving a response shortly.")}})}};$.fn.changeVal=function(t){return $(this).val(t).trigger("change")};var switchFunction=function(){$(".doc_type_switch").on("switchChange.bootstrapSwitch",function(){$(this).prop("checked")?($(this).parents(".doc_type_row").siblings("div").slideDown("slow"),$(this).parents(".doc_type").addClass("doc_type_pr")):($(this).parents(".doc_type_row").siblings("div").slideUp("slow"),$(this).parents(".doc_type").removeClass("doc_type_pr"))})},uploadControl=function(){uploadControl.prototype.init=function(t,e,a){upload_button=$("<button/>").addClass("btn btn-primary").prop("disabled",!0).text("Processing...").on("click",function(t){t.preventDefault();var e=$(this),a=e.data();e.off("click").text("Abort").on("click",function(){e.remove(),a.abort()}),a.submit().always(function(){e.remove()})}),up_url=window.location.toString(),up_url=up_url.slice(0,up_url.lastIndexOf("/")+1)+"/int/int_upload_handler.php",$("#"+t).fileupload({url:up_url,type:"POST",autoUpload:!1,maxFileSize:999e3,acceptFileTypes:/(\.|\/)(pdf|doc|docx)$/i,dataType:"json",done:function(t,e){$("pre",e.result).text()},progressall:function(t,e){var a=parseInt(e.loaded/e.total*100,10);$("#progress .progress-bar").css("width",a+"%")}}).on("fileuploadprocessalways",function(t,e){var a=e.index;e.files[a],$(e.context.children()[a]);a+1===e.files.length&&e.context.find("button").text("Upload").prop("disabled",!!e.files.error)}).on("fileuploadadd",function(t,a){$.each(a.files,function(t,s){t||(a.context=$('<div class="col-md-3 upload-file-names"></div>').appendTo("#"+e),a.context.data(a),remove_cross=$('<span class="file-close-cross">X</span>'),a.context.append(remove_cross),remove_cross.data(a),remove_cross.click(function(){$(this).data().abort(),$(this).parent().remove()}),a.context.append(s.name),a.context.append(upload_button.clone(!0).data(a)))})}).on("fileuploaddone",function(t,e){$.each(e.result.files,function(t,a){if(a.url)$(e.context[t]).addClass("file_uploaded").attr("data-upload-name",a.name);else if(a.error){var s=$('<span class="text-danger"/>').text(a.error);$(e.context.children()[t]).append("<br>").append(s)}})}).prop("disabled",!$.support.fileInput).parent().addClass($.support.fileInput?void 0:"disabled")}};$(document).ready(function(){ajCalls.ajPath="ajCalls/dbCalls.php",ajCalls.getTransactions(),ajCalls.client_id=1,ajCalls.agent_id=1;var t=ajCalls.loadStates();re_to_ec.init();var e=new Rule_Engine;e.set_ajPath("ajCalls/ruleCalls.php").set_tool("DemoOrderTitle").set_exactMatch(!0).set_procType(1);var a={actionButton:'<button class="btn btn-default no-print" type="button" title="{{ctx.text}} no-print">{{ctx.content}}</button>',actionDropDownCheckboxItem:'<li><label class="{{css.dropDownItem}}"><input name="{{ctx.name}}" type="checkbox" value="1" class="{{css.dropDownItemCheckbox}}" {{ctx.checked}} /> {{ctx.label}}</label></li>',actions:'<div class="{{css.actions}}"></div>',col2:'<div class="col-sm-2"></div>',col25:'<div class="col-sm-3"></div>',icon:'<span class="{{css.icon}} {{ctx.iconCss}}"></span>',label:'<div class="col-sm-3 top-label"> </div>',row:'<div class="row"></div>',inputcheckbox:'<div class="col-sm-3 les-input">{{ctx:elementString}} <span> {{ctx.label}}</span></div>',inputradio:'<div class="col-sm-3 les-input">{{ctx:elementString}} <span> {{ctx.label}}</span></div>',inputtext:'<div class="col-sm-3 top-label">{{ctx.label}}</div><div class="col-sm-3 les-input">{{ctx.elementString}}</div>',print_title:'<div class="col-sm-12 print-title" style="text-align: center">{{ctx.print_title}}</div>',inputpassword:'<div class="col-sm-3 top-label">{{ctx.label}}</div><div class="col-sm-3 les-input">{{ctx.elementString}}</div>',title:'<div class="fs-title col-sm-12" style="text-align: center">{{ctx.title}}</div>',submitButton:"<div class=\"calcBtn no-print\"><button class='btn btn-block btn-lg btn-info no-print'>{{ctx.text}}</button></div>"},s={templates:a,title:"Loan Estimate Calculator (BETA!)",print_title:"Calculation Inputs",attribute:{id:"disclosure_form"},submitButton:{text:"Calculate",attribute:{id:"submit_disclosure_btn"},event:{eventType:"click",functionCall:function(t){t.preventDefault();var e=!1;if($(".les-required").each(function(t){(null===$(this).val()||""===$(this).val())&&(alert("Please enter a value for "+$(this).attr("id")),e=!0)}),e)return!1;var a=$("#disclosure_form").serializeObject(),s={doc_type:{}};a.search_type="GFE",a.sections=["c","d","e","f","g","h","e_br_by","e_br_sel","e_br_len"],"undefined"==typeof a.qst&&(a.qst={}),"undefined"==typeof a.v_qst&&(a.v_qst={}),$.each($(".doc_type form"),function(){if($(this).find(" .doc_type_switch").bootstrapSwitch("state")===!0){var t=($(this).parent("div").attr("id").match(/doc_type_([a-zA-Z]+)/)||[]).length>0?$(this).parent("div").attr("id").match(/doc_type_([a-zA-Z]+)/)[1]:"",e=$(this).serializeObject();s.doc_type[t]=e,"undefined"!=typeof e.qst&&$.extend(a.qst,e.qst),"undefined"!=typeof e.v_qst&&$.extend(a.v_qst,e.v_qst),$.extend(a,s)}}),ajCalls.postForm(a),$("#loan_costs_E_form").click(function(){d($("#fee_br"))})}}},elements:{item1:{"class":"select-block",type:"select",label:"State",attribute:{id:"state",name:"state","data-placeholder":"Select State"},option:t,event:{eventType:"change",functionCall:function(){$("#state").change(function(){$("#disclosure_form input,select").not("#state").changeVal("")});var t=$("#state option:selected").val(),e="undefined"==typeof ajCalls.trans[t]?ajCalls.trans["default"]:ajCalls.trans[t];return $("#transaction option").not('option:contains("Select Option")').remove(),$.each(e,function(t,e){$("#transaction").append($("<option></option>").attr("value",t).text(e))}),$('#transaction option:contains("Select Option")').prop("selected",!0),ajCalls.getCounties($(this).val())}}},item2:{"class":"select-block",type:"select",label:"County",attribute:{id:"county",name:"county","data-placeholder":"Select County"},event:{eventType:"change",functionCall:function(){return $("#county").change(function(){$("#disclosure_form input,select").not("#state,#county").changeVal("")}),ajCalls.getTownships($("#state").val(),$(this).val())}}},item3:{"class":"select-block",type:"select",label:"Township",attribute:{id:"township",name:"township",placeholder:"Select Town"}},item5:{"class":"select-block les-required",type:"select",label:"Transaction",attribute:{id:"transaction",name:"purpose","data-placeholder":"Please Select Transaction Type"},option:{},event:{eventType:"change",functionCall:function(){$(".doc_type_switch").each(function(){$(this).bootstrapSwitch("state",!1)}),"11"===$(this).val()?($("#doc_type_switch_Deed").bootstrapSwitch("state",!0),$("[id='doc_type_switch_Mortgage/Deed of Trust']").bootstrapSwitch("state",!0)):"00"===$(this).val()&&($("[id='doc_type_switch_Release of Real Estate Lien']").bootstrapSwitch("state",!0),$("[id='doc_type_switch_Mortgage/Deed of Trust']").bootstrapSwitch("state",!0))}}}}},i={actionButton:'<button class="btn btn-default" type="button" title="{{ctx.text}}">{{ctx.content}}</button>',actionDropDownCheckboxItem:'<li><label class="{{css.dropDownItem}}"><input name="{{ctx.name}}" type="checkbox" value="1" class="{{css.dropDownItemCheckbox}}" {{ctx.checked}} /> {{ctx.label}}</label></li>',actions:'<div class="{{css.actions}}"></div>',col2:'<div class="col-sm-2"></div>',col25:'<div class="col-sm-6" ></div>',icon:'<span class="{{css.icon}} {{ctx.iconCss}}"></span>',label:'<div class="col-sm-3 top-label"> </div>',row:"<div class='row disclosure_result_row'></div>",inputcheckbox:'<div class="col-sm-3 les-input">{{ctx:elementString}} <span> {{ctx.label}}</span></div>',inputradio:'<div class="col-sm-3 les-input">{{ctx:elementString}} <span> {{ctx.label}}</span></div>',inputtext:'<div class="col-sm-3 top-label">{{ctx.label}}</div><div class="col-sm-3 les-input">{{ctx.elementString}}</div>',title:"<div class=\"col-sm-12 no-padding-col\"><div class='section_header_tab disclosure_result_row'>{{ctx.title}}</div></div>",submitButton:"<div class=\"calcBtn\"><button class='btn btn-block btn-lg btn-info'>{{ctx.text}}</button></div>"},o={title:"Loan Costs",attribute:{id:"loan_costs_form"},templates:i,elements:{item1:{"class":"section_header",type:"text",text:"A. Orgination Charges",attribute:{id:"orgination_charges"}},item2:{"class":"section_header text-right",type:"text",text:"$650",attribute:{id:"orgination_charges_val"}},item3:{"class":"",type:"text",text:"Application Fee",attribute:{id:"orgination_charges_val"}},item4:{"class":"text-right",type:"text",text:"$100",attribute:{id:"orgination_charges_val"}},item5:{"class":"",type:"text",text:"Orgination Fee",attribute:{id:"orgination_charges_val"}},item6:{"class":"text-right",type:"text",text:"$550",attribute:{id:"orgination_charges_val"}}}},n={attribute:{id:"loan_costs_B_form"},templates:i,elements:{item1:{"class":"section_header",type:"text",text:"B. Services You Cannot Shop For",attribute:{id:"charges_B"}},item2:{"class":"section_header text-right",type:"text",text:"$325",attribute:{id:"charges_B_val"}},item3:{"class":"",type:"text",text:"Apprasial Fee",attribute:{id:"charges_B_val"}},item4:{"class":"text-right",type:"text",text:"$250",attribute:{id:"charges_B_val"}},item5:{"class":"",type:"text",text:"Tax Research Fee",attribute:{id:"charges_B_val"}},item6:{"class":"text-right",type:"text",text:"$75",attribute:{id:"charges_B_val"}}}},l={actionButton:'<button class="btn btn-default no-print" type="button" title="{{ctx.text}} no-print">{{ctx.content}}</button>',actionDropDownCheckboxItem:'<li><label class="{{css.dropDownItem}}"><input name="{{ctx.name}}" type="checkbox" value="1" class="{{css.dropDownItemCheckbox}}" {{ctx.checked}} /> {{ctx.label}}</label></li>',actions:'<div class="{{css.actions}}"></div>',col2:'<div class="col-sm-2"></div>',col25:'<div class="col-sm-3"></div>',icon:'<span class="{{css.icon}} {{ctx.iconCss}}"></span>',label:'<div class="col-sm-3 top-label"> </div>',row:'<div class="row doc_type_row"></div>',inputcheckbox:'<div class="col-sm-3 les-input">{{ctx:elementString}} <span> {{ctx.label}}</span></div>',inputradio:'<div class="col-sm-3 les-input">{{ctx:elementString}} <span> {{ctx.label}}</span></div>',inputtext:'<div class="col-sm-3 top-label">{{ctx.label}}</div><div class="col-sm-3 les-input">{{ctx.elementString}}</div>',print_title:'<div class="col-sm-12 print-title" style="text-align: center">{{ctx.print_title}}</div>',title:'<div class="col-sm-6 top-label" for="doc_type_switch_{{ctx.title}}">{{ctx.title}}</div><div class="col-sm-3 col-sm-offset-3 text-right no-print"><input type="checkbox" data-on-text="YES" data-off-text="NO" name="custom-square-switch-icons" data-on-color="info" id="doc_type_switch_{{ctx.title}}" class="doc_type_switch" /></div>',submitButton:"<div class=\"calcBtn\"><button class='btn btn-block btn-lg btn-info'>{{ctx.text}}</button></div>"},c={};c.deed={div_id:"doc_type_deed",title:"Deed",attribute:{id:"doc_type_deed_form"},templates:l,elements:{item1:{"class":"form-control",label:"Page Count",type:"input",attribute:{id:"deed_page_count",name:"page_count",value:3,type:"text"}}}},c.mort={div_id:"doc_type_mort",title:"Mortgage/Deed of Trust",attribute:{id:"doc_type_mort_form"},templates:l,elements:{item1:{"class":"form-control",label:"Page Count",type:"input",attribute:{id:"mort_page_count",name:"page_count",value:25,type:"text"}}}},c.release={div_id:"doc_type_release",title:"Release of Real Estate Lien",attribute:{id:"doc_type_release_form"},templates:l,elements:{item1:{"class":"form-control",label:"Page Count",type:"input",attribute:{id:"release_page_count",name:"page_count",value:3,type:"text"}},item2:{"class":"form-control",label:"Number Of Releases Being Filed",type:"input",attribute:{id:"release_num_count",name:"num_count",value:1,type:"text"}}}},c.ass={div_id:"doc_type_assign",title:"Assignment",attribute:{id:"doc_type_assign_form"},templates:l,elements:{item1:{"class":"form-control",label:"Page Count",type:"input",attribute:{id:"assign_page_count",name:"page_count",value:3,type:"text"}},item2:{"class":"form-control",label:"Number Of Assignments Being Filed",type:"input",attribute:{id:"assign_num_count",name:"num_count",value:1,type:"text"}}}},c.mod={div_id:"doc_type_mod",title:"Modification",attribute:{id:"doc_type_mod_form"},templates:l,elements:{item1:{"class":"form-control",label:"Page Count",type:"input",attribute:{id:"mod_page_count",name:"page_count",value:3,type:"text"}}}},c.att={div_id:"doc_type_att",title:"Power of Attorney",attribute:{id:"doc_type_att_form"},templates:l,elements:{item1:{"class":"form-control",label:"Page Count",type:"input",attribute:{id:"att_page_count",name:"page_count",value:3,type:"text"}}}},$("#formContainer").dynamicform(s),$("#loan_costs_start").dynamicform(o),$("#loan_costs_B").dynamicform(n),$.each(c,function(){container_div=this.div_id,delete this.div_id,$("#"+container_div).dynamicform(this)}),$("#doc_type_deed").dynamicform(doc_type_deed),$("#disclosure_form").find(":input").each(function(){$(this).change(function(){re_to_ec.update(this)})});var r=e.compute_rules("init");"undefined"!=typeof r&&($.each(r,function(t,e){var a=JSON.parse(e.result_options);$("#tit_overlay_form").dynamicform(a)}),e.set_enabledResults(r,"init"),up_frm=new uploadControl,up_frm.init("tit_up","files","tit_overlay")),$("#mask, #overlay_close").click(function(){$("#mask").hide(),$("#ov_card").flip(!1)}).children().click(function(t){t.stopPropagation()}),$("#print_quote").click(function(){$(".main-row").print({globalStyles:!0,mediaPrint:!1,stylesheet:null,noPrintSelector:".no-print",iframe:!0,append:"#disclosure_form,.doc_type_pr",prepend:null,manuallyCopyFormValues:!0,deferred:$.Deferred()})}),$(".doc_type_switch").bootstrapSwitch(),ls_helper.switchFunction(),$("#email_quote").click(function(){var t=prompt("email address","test@lodestarss.com"),e="Loan Estimate Quote",a=$(".main-row").clone(),s=$("head").clone();s.append('<link rel="stylesheet" type="text/css" href="css/pdf.css"/>'),s.cssAbsURL();var i="This is a loan estimate email",o={type:"application/pdf",name:"loan estimate.pdf",html:"<!DOCTYPE html><html>"+s.html()+"<body>"+a.html()+"</body></html>"};ajCalls.email(t,e,i,o)}),$("#ov_card").flip({axis:"y",reverse:!0,trigger:"none",speed:1e3}),$("#order_tit_btn").click(function(){d($("#tit_or"))}),$(".cancel_back").click(function(){$("#ov_card").flip(!1)});var d=function(t){$(".card_back").not(t).hide(),t.show(),$("#ov_card").flip(!0)};$("#submit_order").click(function(t){if(t.preventDefault(),"default"===$("#tit_port option:selected").val())return void alert("Please select which portal you would like to use");if(""===$("#message_txt_area").val())return void alert("Please enter instructions for the Title Agent");var e=[];$(".file_uploaded").each(function(){e.push($(this).attr("data-upload-name"))});var a=$("#tit_port option:selected").val(),s={html:p()},i={state:$("#state").val(),transaction:$("#transaction option:selected").text(),file_names:e,html_attachment:s};titCalls.postTitle($("#message_txt_area").val(),i,a)});var p=function(){var t=$(".main-row").clone(),e=$("head").clone();e.append('<link rel="stylesheet" type="text/css" href="css/pdf.css"/>'),e.cssAbsURL();var a="<!DOCTYPE html><html>"+e.html()+"<body>"+t.html()+"</body></html>";return a}});